# sniffer
基于win32和npcap环境开发的抓包程序

 - 项目说明：
 ```
 这只是一个实验课的项目，开发周期只有一个星期，软件可能有bug，内存管理上可能有点问题
 该程序使用npcap提供的接口，实现程序的抓包功能，自行撰写了数据链路层、网络层、传输层中几种常用协议的包头解析，采用多
 线程形式实现抓包和解析并发，所捕获到的数据包指针先会被放入包管理队列等待解析，被解析后的数据会被存在内存中以供用户回调查看。
 抓包过程中所有包数据会被以libpcap格式临时缓存在TempData文件夹下，该路径可在程序中自行修改，程序结束时将自动清除，如果它权限
 足够的话，用户可以自行选择数据包的存储路径，也可以读取包数据后再另存为新路径。
 ```
 
 - 实验环境：
```
IDE：VS2019
依赖：npcap1.55
程序类型：win32应用程序
图形化界面实现方式：win32API
编程语言：C
```

- 文件说明：
```
Sniffer.cpp    主界面
Parse.cpp      包解析
Packetque.cpp  包管理
Capture.cpp    包捕获
Misc.cpp       其他功能性函数，如输出调试信息、字符类型转换等
```

- 程序功能：
```
1.抓包
2.多线程实现抓包和解析并发
3.包可以解析到传输层，且提供扩展，由于时间原因没有继续做应用层解析
4.提供数据包保存功能，以libpcap格式保存数据包
5.用户可以自定义数据包保存路径
6.程序运行过程会缓存数据包文件在TempData文件夹中，如果有权限的话，在程序结束时会自动清除所产生的缓存文件
7.可以读取并解析libpcap格式数据包，显示效果与在线抓包效果相同
9.支持解析的包类型：以太网数据帧、arp协议、ipv4协议、ipv6协议、icmp协议、tcp协议、udp协议，可识别http和https数据包
10.支持捕获过滤，过滤表达式语法参见npcap
```
